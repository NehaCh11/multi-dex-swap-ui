import{__awaiter as t}from"../../external/tslib/tslib.es6.js";import{Zero as s,AddressZero as e}from"@ethersproject/constants";import{Contract as a}from"@ethersproject/contracts";import"../../external/lodash.clonedeep/index.js";import{SwapTypes as o}from"../../types.js";import{parseNewPool as n}from"../index.js";import{bnum as I,ZERO as d}from"../../utils/bignumber.js";import u from"../../abi/Vault.json.js";import{EMPTY_SWAPINFO as x}from"../../constants.js";import{exports as D}from"../../_virtual/index.js";const c={Networks:[1,42],stETH:{1:"0xae7ab96520de3a18e5e111b5eaab095312d7fe84",42:"0x4803bb90d18a1cb7a2187344fe4feb0e07878d05"},wstETH:{1:"0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0",42:"0xa387b91e393cfb9356a460370842bc8dbb2f29af"},WETH:{1:"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",42:"0xdfcea9088c8a88a76ff74892c1457c17dfeef9c1"},DAI:{1:"0x6b175474e89094c44da98b954eedeac495271d0f",42:"0x04df6e4121c27713ed22341e7c7df330f56f289b"},USDC:{1:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",42:"0xc2569dd7d0fd715b054fbf16e75b001e5c0c1115"},USDT:{1:"0xdac17f958d2ee523a2206206994597c13d831ec7",42:"0xcc08220af469192c53295fdd34cfb8df29aa17ab"},StaticPools:{staBal:{1:"0x06df3b2bbb68adc8b0e302443692037ed9f91b42000000000000000000000063",42:"0x45f78862bd3aa5205e63141fa7f2d35f38eb87c30000000000000000000000fd"},wethDai:{1:"0x0b09dea16768f0799065c475be02919503cb2a3500020000000000000000001a",42:"0x3a19030ed746bd1c3f2b0f996ff9479af04c5f0a000200000000000000000004"},wstEthWeth:{1:"0x32296969ef14eb0c6d29669c550d4a0449130230000200000000000000000080",42:"0xe08590bde837eb9b2d42aa1196469d6e08fe96ec000200000000000000000101"}}},l={1:{},42:{}};function w(t,s,e){return!!c.Networks.includes(t)&&(s=s.toLowerCase(),e=e.toLowerCase(),s===c.wstETH[t]&&e===c.DAI[t]||s===c.wstETH[t]&&e===c.USDC[t]||s===c.wstETH[t]&&e===c.USDT[t]||s===c.DAI[t]&&e===c.wstETH[t]||s===c.USDC[t]&&e===c.wstETH[t]||s===c.USDT[t]&&e===c.wstETH[t]||s===c.stETH[t]&&e===c.DAI[t]||s===c.stETH[t]&&e===c.USDC[t]||s===c.stETH[t]&&e===c.USDT[t]||s===c.DAI[t]&&e===c.stETH[t]||s===c.USDC[t]&&e===c.stETH[t]||s===c.USDT[t]&&e===c.stETH[t])}function i(s,e){return t(this,void 0,void 0,(function*(){const t=new a(c.wstETH[e],["function tokensPerStEth() external view returns (uint256)"],s);return yield t.tokensPerStEth()}))}function r(w,i,r,E,S,m,T){return t(this,void 0,void 0,(function*(){let p,H=!1;r===c.stETH[i]&&(r=c.wstETH[i],p=!0),E===c.stETH[i]&&(E=c.wstETH[i],H=!0);const O=D(x),h=l[i][`${r}${E}${S}`];return h?(O.tokenAddresses=h.tokenAddresses,O.swaps=h.swaps,O.swapAmount=m,O.swaps[0].amount=O.swapAmount.toString(),O.tokenIn=p?c.stETH[i]:r,O.tokenOut=H?c.stETH[i]:E,O.marketSp=function(t,s,e,a){const u=[];for(let x=0;x<s.length;x++){const D=s[x],c=a.filter((t=>t.id===D.poolId));if(1!==c.length)return I(0);const l=n(c[0]);if(!l)return I(0);const w=l.parsePoolPairData(e[D.assetInIndex],e[D.assetOutIndex]);let i;i=t===o.SwapExactIn?l._spotPriceAfterSwapExactTokenInForTokenOut(w,d):l._spotPriceAfterSwapTokenInForExactTokenOut(w,d),u.push(i)}return u.reduce(((t,s)=>t.times(s)))}(S,O.swaps,O.tokenAddresses,w).toString(),O.returnAmount=yield function(n,I,d,x){return t(this,void 0,void 0,(function*(){const t=new a("0xBA12222222228d8Ba445958a75a0704d566BF2C8",u,x),D={sender:e,recipient:e,fromInternalBalance:!1,toInternalBalance:!1};try{const s=yield t.callStatic.queryBatchSwap(n,I,d,D);return n===o.SwapExactIn?s[d.length-1].mul(-1):s[0]}catch(t){return console.error("SOR - Lido Static Route QueryBatchSwap Error. No swaps."),s}}))}(S,O.swaps,O.tokenAddresses,T),O.returnAmount.isZero()?D(x):(O.returnAmountConsideringFees=O.returnAmount,O)):O}))}l[1][`${c.DAI[1]}${c.wstETH[1]}0`]={name:"DAI/wstETH-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.DAI[1],c.WETH[1],c.wstETH[1]],swaps:[{poolId:c.StaticPools.wethDai[1],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"}]},l[1][`${c.wstETH[1]}${c.DAI[1]}0`]={name:"wstETH/DAI-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.wstETH[1],c.WETH[1],c.DAI[1]],swaps:[{poolId:c.StaticPools.wstEthWeth[1],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"}]},l[1][`${c.DAI[1]}${c.wstETH[1]}1`]={name:"DAI/wstETH-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.DAI[1],c.WETH[1],c.wstETH[1]],swaps:[{poolId:c.StaticPools.wstEthWeth[1],amount:"",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[1][`${c.wstETH[1]}${c.DAI[1]}1`]={name:"wstETH/DAI-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.wstETH[1],c.WETH[1],c.DAI[1]],swaps:[{poolId:c.StaticPools.wethDai[1],amount:"",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[1],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[1][`${c.USDC[1]}${c.wstETH[1]}0`]={name:"USDC/wstETH-SwapExactIn",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDC[1],c.DAI[1],c.WETH[1],c.wstETH[1]],swaps:[{poolId:c.StaticPools.staBal[1],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[1],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[1][`${c.USDC[1]}${c.wstETH[1]}1`]={name:"USDC/wstETH-SwapExactOut",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDC[1],c.DAI[1],c.WETH[1],c.wstETH[1]],swaps:[{poolId:c.StaticPools.wstEthWeth[1],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[1],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[1][`${c.wstETH[1]}${c.USDC[1]}0`]={name:"wstETH/USDC-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[1],c.WETH[1],c.DAI[1],c.USDC[1]],swaps:[{poolId:c.StaticPools.wstEthWeth[1],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[1],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[1][`${c.wstETH[1]}${c.USDC[1]}1`]={name:"wstETH/USDC-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[1],c.WETH[1],c.DAI[1],c.USDC[1]],swaps:[{poolId:c.StaticPools.staBal[1],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[1],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[1][`${c.USDT[1]}${c.wstETH[1]}0`]={name:"USDT/wstETH-SwapExactIn",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDT[1],c.DAI[1],c.WETH[1],c.wstETH[1]],swaps:[{poolId:c.StaticPools.staBal[1],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[1],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[1][`${c.USDT[1]}${c.wstETH[1]}1`]={name:"USDT/wstETH-SwapExactOut",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDT[1],c.DAI[1],c.WETH[1],c.wstETH[1]],swaps:[{poolId:c.StaticPools.wstEthWeth[1],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[1],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[1][`${c.wstETH[1]}${c.USDT[1]}0`]={name:"wstETH/USDT-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[1],c.WETH[1],c.DAI[1],c.USDT[1]],swaps:[{poolId:c.StaticPools.wstEthWeth[1],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[1],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[1][`${c.wstETH[1]}${c.USDT[1]}1`]={name:"wstETH/USDT-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[1],c.WETH[1],c.DAI[1],c.USDT[1]],swaps:[{poolId:c.StaticPools.staBal[1],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[1],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[1],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[42][`${c.USDC[42]}${c.wstETH[42]}0`]={name:"USDC/wstETH-SwapExactIn",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDC[42],c.WETH[42],c.wstETH[42]],swaps:[{poolId:c.StaticPools.wethDai[42],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"}]},l[42][`${c.wstETH[42]}${c.USDC[42]}0`]={name:"wstETH/USDC-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[42],c.WETH[42],c.USDC[42]],swaps:[{poolId:c.StaticPools.wstEthWeth[42],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"}]},l[42][`${c.USDC[42]}${c.wstETH[42]}1`]={name:"USDC/wstETH-SwapExactOut",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDC[42],c.WETH[42],c.wstETH[42]],swaps:[{poolId:c.StaticPools.wstEthWeth[42],amount:"",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[42][`${c.wstETH[42]}${c.USDC[42]}1`]={name:"wstETH/USDC-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[42],c.WETH[42],c.USDC[42]],swaps:[{poolId:c.StaticPools.wethDai[42],amount:"",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[42],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[42][`${c.DAI[42]}${c.wstETH[42]}0`]={name:"DAI/wstETH-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.DAI[42],c.USDC[42],c.WETH[42],c.wstETH[42]],swaps:[{poolId:c.StaticPools.staBal[42],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[42],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[42][`${c.DAI[42]}${c.wstETH[42]}1`]={name:"DAI/wstETH-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.DAI[42],c.USDC[42],c.WETH[42],c.wstETH[42]],swaps:[{poolId:c.StaticPools.wstEthWeth[42],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[42],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[42][`${c.wstETH[42]}${c.DAI[42]}0`]={name:"wstETH/DAI-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.wstETH[42],c.WETH[42],c.USDC[42],c.DAI[42]],swaps:[{poolId:c.StaticPools.wstEthWeth[42],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[42],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[42][`${c.wstETH[42]}${c.DAI[42]}1`]={name:"wstETH/DAI-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:18,tokenAddresses:[c.wstETH[42],c.WETH[42],c.USDC[42],c.DAI[42]],swaps:[{poolId:c.StaticPools.staBal[42],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[42],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[42][`${c.USDT[42]}${c.wstETH[42]}0`]={name:"USDT/wstETH-SwapExactIn",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDT[42],c.USDC[42],c.WETH[42],c.wstETH[42]],swaps:[{poolId:c.StaticPools.staBal[42],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[42],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[42][`${c.USDT[42]}${c.wstETH[42]}1`]={name:"USDT/wstETH-SwapExactOut",tokenInDecimals:6,tokenOutDecimals:18,tokenAddresses:[c.USDT[42],c.USDC[42],c.WETH[42],c.wstETH[42]],swaps:[{poolId:c.StaticPools.wstEthWeth[42],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[42],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]},l[42][`${c.wstETH[42]}${c.USDT[42]}0`]={name:"wstETH/USDT-SwapExactIn",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[42],c.WETH[42],c.USDC[42],c.USDT[42]],swaps:[{poolId:c.StaticPools.wstEthWeth[42],amount:"",assetInIndex:0,assetOutIndex:1,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.staBal[42],amount:"0",assetInIndex:2,assetOutIndex:3,userData:"0x"}]},l[42][`${c.wstETH[42]}${c.USDT[42]}1`]={name:"wstETH/USDT-SwapExactOut",tokenInDecimals:18,tokenOutDecimals:6,tokenAddresses:[c.wstETH[42],c.WETH[42],c.USDC[42],c.USDT[42]],swaps:[{poolId:c.StaticPools.staBal[42],amount:"",assetInIndex:2,assetOutIndex:3,userData:"0x"},{poolId:c.StaticPools.wethDai[42],amount:"0",assetInIndex:1,assetOutIndex:2,userData:"0x"},{poolId:c.StaticPools.wstEthWeth[42],amount:"0",assetInIndex:0,assetOutIndex:1,userData:"0x"}]};export{c as Lido,l as Routes,r as getLidoStaticSwaps,i as getStEthRate,w as isLidoStableSwap};
//# sourceMappingURL=index.js.map
