import{BigNumber as s}from"@ethersproject/bignumber";import{WeiPerEther as u}from"@ethersproject/constants";import{virtualOffset0 as b,virtualOffset1 as t,calcXpXpDivLambdaLambda as r}from"./gyroEMathHelpers.js";import{ONE_XP as o}from"../../gyroHelpers/constants.js";import{divDown as c,mulDown as n,divDownMagU as a,divUpMagU as d,mulUpXpToNpU as m,divXpU as e,mulDownMagU as f,mulUpMagU as l,mulDownXpToNpU as y,sqrt as i}from"../../gyroHelpers/gyroSignedFixedPoint.js";function x(s,u,r,o){const c={x:b(u,r,o),y:t(u,r,o)};return g(u.lambda,s,u.s,u.c,o,c,r.tauBeta,r.dSq)}function p(s,u,r,o){const c={x:t(u,r,o),y:b(u,r,o)};return g(u.lambda,s,u.c,u.s,o,c,{x:r.tauAlpha.x.mul(-1),y:r.tauAlpha.y},r.dSq)}function g(u,b,t,x,p,g,R,h){const j={x:o.sub(a(a(o,u),u)),y:o.sub(d(d(o,u),u))},H={a:s.from(0),b:s.from(0),c:s.from(0)},S=b.sub(g.x);H.b=m(f(t,x),e(j.y,h));const q={x:e(f(f(j.y,t),t),h),y:e(l(l(j.x,t),t),h.add(1)).add(1)};return q.x=o.sub(q.x),q.y=o.sub(q.y),H.c=r(b,p,u,t,x,R,h).mul(-1),H.c=H.c.add(y(f(p.y,p.y),q.y)),H.c=H.c.gt(s.from(0))?i(H.c,s.from(5)):s.from(0),H.c=n(n(H.c,u),u),H.c=c(S,H.c),H.b.sub(H.c).gt(s.from(0))?H.a=m(H.b.sub(H.c),e(o,q.y).add(1)):H.a=m(H.b.sub(H.c),e(o,q.x)),H.a}function R(r,o,a,d,m,e){const f=m.y,{c:l,s:y,lambda:x}=o,[p,g]=r,R=b(o,a,m),h=t(o,a,m),j=u.sub(c(u,n(x,x))),H=u.sub(d);let S;return S=i(0===e?n(n(f,f),u.sub(n(j,n(y,y)))).sub(c(n(p.sub(R),p.sub(R)),n(x,x))):n(n(f,f),u.sub(n(j,n(l,l)))).sub(c(n(g.sub(h),g.sub(h)),n(x,x))),s.from(5)),{x0:p,y0:g,c:l,s:y,lambda:x,a:R,b:h,ls:j,f:H,r:f,R:S}}function h(s,b,t,r,o){const{y0:a,c:d,s:m,lambda:e,b:f,ls:l,R:y}=R(s,b,t,r,o,1);return c(n(c(u,u.sub(n(l,n(d,d)))),n(y,n(n(n(n(n(l,m),d),n(e,e)),y).sub(a.sub(f)),n(n(n(n(l,m),d),n(e,e)),y).sub(a.sub(f))))),n(n(e,e),n(y,y)).add(n(a.sub(f),a.sub(f))))}function j(s,b,t,r,o){const{x0:a,c:d,s:m,lambda:e,a:f,ls:l,R:y}=R(s,b,t,r,o,0);return c(n(c(u,u.sub(n(l,n(m,m)))),n(y,n(n(n(n(n(l,m),d),n(e,e)),y).sub(a.sub(f)),n(n(n(n(l,m),d),n(e,e)),y).sub(a.sub(f))))),n(n(e,e),n(y,y)).add(n(a.sub(f),a.sub(f))))}function H(s,b,t,r,o){const{x0:a,c:d,s:m,lambda:e,a:f,ls:l,R:y}=R(s,b,t,r,o,0);return c(n(u.sub(n(l,n(m,m))),c(u,n(n(e,e),y)).add(c(n(a.sub(f),a.sub(f)),n(n(n(e,e),n(e,e)),n(y,n(y,y)))))),n(n(n(l,m),d).sub(c(a.sub(f),n(n(e,e),y))),n(n(l,m),d).sub(c(a.sub(f),n(n(e,e),y)))))}function S(s,b,t,r,o){const{y0:a,c:d,s:m,lambda:e,b:f,ls:l,R:y}=R(s,b,t,r,o,1);return c(n(u.sub(n(l,n(d,d))),c(u,n(n(e,e),y)).add(c(n(a.sub(f),a.sub(f)),n(n(n(e,e),n(e,e)),n(y,n(y,y)))))),n(n(n(l,m),d).sub(c(a.sub(f),n(n(e,e),y))),n(n(l,m),d).sub(c(a.sub(f),n(n(e,e),y)))))}function q(s,b,t,r,o){const{x0:a,s:d,lambda:m,a:e,ls:f,R:l,f:y}=R(s,b,t,r,o,0);return n(c(u,n(y,u.sub(n(f,n(d,d))))),c(u,n(n(m,m),l)).add(c(n(a.sub(e),a.sub(e)),n(n(n(m,m),n(m,m)),n(n(l,l),l)))))}function A(s,b,t,r,o){const{y0:a,c:d,lambda:m,b:e,ls:f,R:l,f:y}=R(s,b,t,r,o,1);return n(c(u,n(y,u.sub(n(f,n(d,d))))),c(u,n(n(m,m),l)).add(c(n(a.sub(e),a.sub(e)),n(n(n(m,m),n(m,m)),n(n(l,l),l)))))}export{p as calcSpotPriceXGivenY,x as calcSpotPriceYGivenX,q as dPxDXOut,S as dPxDYIn,H as dPyDXIn,A as dPyDYOut,j as normalizedLiquidityXIn,h as normalizedLiquidityYIn};
//# sourceMappingURL=gyroEMathFunctions.js.map
